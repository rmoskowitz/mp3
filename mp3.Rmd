---
title: "Camping is so In-Tents: MacLeish Site Recommendations"
author: Rachel Moskowitz, Sonia Garfinkel, and Greta Mundt
output: 
  html_document:
    df_print: paged
    code_folding: hide
    theme: "journal"
---
To- do
- Rachel put in points for intended campsite
- Sonia figure out the st_union for research and challenge
- Greta and Sonia work together on all the aesthetics, make the maps super pretty :)
- Greta work on writing up the "resources necessary to implement"
- Rachel work on "campsite recommendation"
- make sure everything knits! 

#####Problem statement: 
MacLeish currently only has two campsites, one large group site close to the building, and a remote campsite with two tent platforms a mile away. There is a need for an additional campsite at the field station. There is an interest in developing a new campsite half a mile away from the parking area, within 200' of a stream or water source, 500' away from any research area or Challenge Course element, in a forest unlike the forest of the other two campsites, and relatively flat. All of these components must be present in a new campsite for consideration.


#####Campsite recommendation
Our project proposese two new potential campsite locations for MacLeish. Our final recommendations for new campsite locations are shown in our map below with blue pop up identifiers. We used a github repository in order to keep track of and evaluate the spatial data necessary for making our recommendations [^1]. These locations were chosen based on the following criteria and spatial analysis procedures.
1. Campsites must be located in a forest unlike the forest of the other two campsites. The existing campsites are located in an Old Field White Pine Forest and a Sugar Maple Forest, which can be found by clicking on the vegetation near these popups on the map below. We knew we could not place our new proposed campsites in either of these vegetation types. The limited our proposed campsites. We chose to place these campsites within the (name two other vegetation types)
2. water source buffer info
3. research and challenge course info
4. away from parking lot info
5. relatively flat info
How we came to our final decision


```{r,  message = FALSE, warning = FALSE}
library(tidyverse)
library(sf)
library(macleish)
library(leaflet)
```

```{r}
#we added the existing group campsites as data.frames
group_campsite1 <- data.frame(lat = 42.450976, lon = -72.678154)
group_campsite2 <-data.frame(lat = 42.458549, lon = -72.679581)
#adding the parking lot as a data.frame
parking_lot <-data.frame(lat = 42.448013, lon = -72.680663)

#transforming parking lot data.frame to an sf object with defined projection
parking_sf <- parking_lot %>%
  st_as_sf(coords = c("lon", "lat"), crs = 4326)

```


```{r}
#projection for our buffers
proj4_aea <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"

#making a buffer of 200' for the stream, have to convert feet to meters for the distqnce and put it all in the correct projection system 
stream_buffer <- macleish_layers[["streams"]] %>%
  st_transform(proj4_aea) %>%
   st_buffer(dist = 60.96) %>%
  st_transform(4326)

#this is the research buffer, with conversions for meters 
research_buffer <- macleish_layers[["research"]] %>%
   st_transform(proj4_aea) %>%
  st_buffer(dist = 152.4) %>%
  st_transform(4326)
 
#500' buffer around challenge courses
challenge_buffer <- macleish_layers[["challenge_courses"]] %>%
   st_transform(proj4_aea) %>%
  st_buffer(dist = 152.4) %>%
  st_transform(4326)

#half a mile buffer around our parking object
parking_buffer <- parking_sf %>%
  st_transform(proj4_aea) %>%
  st_buffer(dist = 804.7) %>%
  st_transform(4326)

#use st_union() to group challenge course buffer and research buffers together
res_challenge_union <- st_union(challenge_buffer, research_buffer, by_feature = FALSE)
```


```{r}
#define color palettes (for forest & for wetlands...)
wetland_pal <- colorNumeric("viridis", 
                  macleish_layers[["wetlands"]]$SHAPE_AREA)
```

Interactive map with buffers: research
This map shows.... (explain the buffers etc)
click on different areas of the map to discover the vegetation type 

```{r}
#interactive leaflet map w/ macleish_layers and own data added
leaflet() %>%
  addTiles() %>%

#displaying types of vegetation with popups
  addPolygons(data = macleish_layers[["forests"]], color = "green", opacity = 5,  weight = 1, popup = ~Sheet1__Na) %>%
  
#how we showed the wetlands with popups
   addPolygons(data = macleish_layers[["wetlands"]], 
              color = "blue", 
              fillOpacity = 0.8, weight = 0.1, 
              popup = ~IT_VALDESC) %>%
  
#add trails, streams, boundary, and contours as layers
  addPolylines(data = macleish_layers[["trails"]], color = "brown", weight = 2) %>%
  
  addPolylines(data = macleish_layers[["streams"]], color = "blue", weight = 3) %>%
  
  addPolygons(data = macleish_layers[["boundary"]], stroke = TRUE, color = "black", fill = NA, weight = 2, opacity = 2) %>%
  
  addPolylines(data = macleish_layers[["contours_3m"]], color = "black", weight = 1) %>%
  
#add existing campsites and parking lot as popups
  addMarkers(lng = ~lon, lat = ~lat, data = group_campsite1, popup = "Current Group Campsite") %>%
  
  addMarkers(lng= ~lon, lat = ~lat, data = parking_lot, popup = "MacLeish Parking Lot") %>%
  
  addMarkers (lng = ~lon, lat = ~lat, data = group_campsite2, popup = "Current Group Campsite (Remote)") %>%

#add stream buffer 
  addPolygons(data = stream_buffer)  %>%
  
#adding the buffer: union of research and challenge course
  addPolygons(data = res_challenge_union, color = "red", weight = 1, opacity = 1, stroke = FALSE) %>%
  
  addPolygons(data = parking_buffer, color = "brown", stroke = FALSE, weight = 1, opacity = 1)
```


Our second map shows the two campsites we have proposed.


```{r}
#add two new campsites as data.frames
new_campsite1 <-data.frame(lat = , lon = -)
new_campsite2 <-data.frame(lat = , lon = )
  
#convert new campsites to sf objects
new_1 <- new_campsite1 %>%
  st_as_sf(coords = c("lon", "lat"), crs = 4326)

new_2 <- new_campsite2 %>%
  st_as_sf(coords = c("lon", "lat"), crs = 4326)

```

```{r}
#leaflet- map #2 with tiles and base polylines and polygons
leaflet() %>%
  addTiles() %>%
  
    addPolylines(data = macleish_layers[["trails"]], color = "brown", weight = 1) %>%
  
  addPolylines(data = macleish_layers[["streams"]], color = "blue", weight = 3) %>%
  
  addPolygons(data = macleish_layers[["boundary"]], stroke = TRUE, color = "black", fill = NA, weight = 2, opacity = 2) %>%
  
  addMarkers(lng = ~lon, lat = ~lat, data = group_campsite1, popup = "Current Group Campsite") %>%
  
  addMarkers(lng= ~lon, lat = ~lat, data = parking_lot, popup = "MacLeish Parking Lot") %>%
  
  addMarkers (lng = ~lon, lat = ~lat, data = group_campsite2, popup = "Current Group Campsite (Remote)") %>%

  #addition of two proposed sites w/out any buffers
    addMarkers(lng= ~lon, lat = ~lat, data = new_1, popup = "Proposed Group Campsite #1") %>%

  addMarkers(lng= ~lon, lat = ~lat, data = new_2, popup = "Proposed Group Campsite #2")
  
```

Notes for map: add legend ( addLegend("bottomright", 
    title = "MacLeish Layers",
    opacity = 1) ??) --> try to simplify as much as possible 


#####Resources necessary to implement this recommendation
- These two campsites will cost
- This will take....will cost 200 dollars for tent platform, 3000 dollars for lean-to (according to Reid Bertone-Johnson)
- Concerns about environmental impact
- major roadblocks...
- can take a day for a tent platform, can  take several months to create a lean-to
- no additional labor costs, money gets absorbed by CEEDS
- main env concern== wants it to be close to a stream but not far enough away to cause erosion 
- generall not really runoff problems from where they clear land because it just gets absobed by trees further down

- Include relevant external information (look at macleish info)


[^1]: [Link to github repository](https://github.com/rmoskowitz/mp3)